<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Client-side based file storage encryption | Rodolfo Berrios</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/rodber.png">
    <link rel="apple-touch-icon" href="/rodber.png">
    <link rel="alternate" type="application/rss+xml" href="https://rodolfoberrios.com/rss.xml" title="Rodolfo Berrios RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://rodolfoberrios.com/feed.atom" title="Rodolfo Berrios Atom Feed">
    <link rel="alternate" type="application/json" href="https://rodolfoberrios.com/feed.json" title="Rodolfo Berrios JSON Feed">
    <meta name="description" content="Encryption in the client.">
    <meta property="article:published_time" content="2015-03-21T23:23:51.000Z">
    <meta property="og:site_name" content="Rodolfo Berrios">
    <meta property="og:title" content="Client-side based file storage encryption">
    <meta property="og:description" content="Encryption in the client.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://rodolfoberrios.com/2015/03/21/client-side-based-file-storage-encryption/">
    <meta property="og:image" content="https://rodolfoberrios.com/photos/2015-encryption.jpg">
    <meta name="twitter:title" content="Client-side based file storage encryption">
    <meta name="twitter:description" content="Encryption in the client.">
    <meta name="twitter:url" content="https://rodolfoberrios.com/2015/03/21/client-side-based-file-storage-encryption/">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://rodolfoberrios.com/photos/2015-encryption.jpg">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="systems">
    <meta property="article:tag" content="systems">
    <meta name="theme-color" content="#2c3e50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileColor" content="#000000">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preload" href="/assets/css/0.styles.cb22d58f.css" as="style"><link rel="preload" href="/assets/js/app.29ff170a.js" as="script"><link rel="preload" href="/assets/js/6.2d350c7c.js" as="script"><link rel="preload" href="/assets/js/3.042bda6b.js" as="script"><link rel="preload" href="/assets/js/23.64d43cae.js" as="script"><link rel="prefetch" href="/assets/js/10.3c1b6871.js"><link rel="prefetch" href="/assets/js/11.14cf862f.js"><link rel="prefetch" href="/assets/js/12.427def72.js"><link rel="prefetch" href="/assets/js/13.43903feb.js"><link rel="prefetch" href="/assets/js/14.c5cb96ce.js"><link rel="prefetch" href="/assets/js/15.2dbe8386.js"><link rel="prefetch" href="/assets/js/16.d2eee437.js"><link rel="prefetch" href="/assets/js/17.1131ddde.js"><link rel="prefetch" href="/assets/js/18.1eccb7be.js"><link rel="prefetch" href="/assets/js/19.047a78e5.js"><link rel="prefetch" href="/assets/js/20.b73e29df.js"><link rel="prefetch" href="/assets/js/21.9456f1d3.js"><link rel="prefetch" href="/assets/js/22.8ec087ff.js"><link rel="prefetch" href="/assets/js/24.f8d305c8.js"><link rel="prefetch" href="/assets/js/25.85d3b050.js"><link rel="prefetch" href="/assets/js/26.ea720f03.js"><link rel="prefetch" href="/assets/js/27.bbcca9e7.js"><link rel="prefetch" href="/assets/js/28.38a6b416.js"><link rel="prefetch" href="/assets/js/29.0df3f5e5.js"><link rel="prefetch" href="/assets/js/30.e33956a1.js"><link rel="prefetch" href="/assets/js/31.64e62c0f.js"><link rel="prefetch" href="/assets/js/32.d7511caa.js"><link rel="prefetch" href="/assets/js/33.b2a33e63.js"><link rel="prefetch" href="/assets/js/34.3afbd281.js"><link rel="prefetch" href="/assets/js/35.e27dc2ac.js"><link rel="prefetch" href="/assets/js/36.f0473d75.js"><link rel="prefetch" href="/assets/js/37.36e0eed7.js"><link rel="prefetch" href="/assets/js/38.a7de7fae.js"><link rel="prefetch" href="/assets/js/39.7f909a9c.js"><link rel="prefetch" href="/assets/js/4.a5a6adf8.js"><link rel="prefetch" href="/assets/js/40.8c9c3358.js"><link rel="prefetch" href="/assets/js/41.35a2fd8e.js"><link rel="prefetch" href="/assets/js/42.9fa8465d.js"><link rel="prefetch" href="/assets/js/43.9d3040ee.js"><link rel="prefetch" href="/assets/js/44.b79380db.js"><link rel="prefetch" href="/assets/js/45.9f615ee6.js"><link rel="prefetch" href="/assets/js/46.7a6bee1e.js"><link rel="prefetch" href="/assets/js/47.d99aa854.js"><link rel="prefetch" href="/assets/js/48.6be8e7fa.js"><link rel="prefetch" href="/assets/js/49.7e9bd27a.js"><link rel="prefetch" href="/assets/js/5.c507ac20.js"><link rel="prefetch" href="/assets/js/50.964aa997.js"><link rel="prefetch" href="/assets/js/51.f98e3edc.js"><link rel="prefetch" href="/assets/js/52.32729a44.js"><link rel="prefetch" href="/assets/js/53.d541b857.js"><link rel="prefetch" href="/assets/js/54.afa806f8.js"><link rel="prefetch" href="/assets/js/55.3b81517a.js"><link rel="prefetch" href="/assets/js/56.72cd0006.js"><link rel="prefetch" href="/assets/js/57.ffc24ebd.js"><link rel="prefetch" href="/assets/js/58.535a1f12.js"><link rel="prefetch" href="/assets/js/59.f2127a35.js"><link rel="prefetch" href="/assets/js/60.c927e111.js"><link rel="prefetch" href="/assets/js/61.9b0e807f.js"><link rel="prefetch" href="/assets/js/62.f70e4840.js"><link rel="prefetch" href="/assets/js/63.f8ce2eef.js"><link rel="prefetch" href="/assets/js/64.e2ce54b4.js"><link rel="prefetch" href="/assets/js/65.c4536268.js"><link rel="prefetch" href="/assets/js/66.3c384577.js"><link rel="prefetch" href="/assets/js/67.458b3a2d.js"><link rel="prefetch" href="/assets/js/68.ebdcf266.js"><link rel="prefetch" href="/assets/js/7.e0e0be5a.js"><link rel="prefetch" href="/assets/js/8.9dfc6da0.js"><link rel="prefetch" href="/assets/js/9.a5a8acdc.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.e12a8b30.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cb22d58f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><nav class="navbar navbar-expand-md navbar-light"><div class="container"><a href="/" class="navbar-brand"><img src="/avatars/rodber.png">
            Rodolfo Berrios
          </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg> <div class="collapse navbar-collapse"><ul class="navbar-nav ml-auto"><li class="nav-item"><a href="/tag/" class="nav-link">Tags</a></li><li class="nav-item"><a href="/about/" class="nav-link">About</a></li> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <a href="/rss.xml" class="feed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></ul></div></div></nav></div></header></section> <div class="container wrapmain"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><div class="row justify-content-center"><div class="col-md-8"><header><span class="text-muted"><div class="post-meta"><!----> <div class="post-meta-date"><time pubdate itemprop="datePublished" datetime="2015-03-21T23:23:51.000Z">
      Sat, Mar 21 2015
    </time></div> <!----></div></span> <h1 itemprop="name headline" class="article-head mt-3">
            Client-side based file storage encryption
          </h1> <p class="lead">Encryption in the client.</p> <div><span><div class="d-flex align-items-center"><div class="profile-avatar"><!----></div> <!----></div></span><span><div class="d-flex align-items-center"><div class="profile-avatar"><!----></div> <!----></div></span><span><div class="d-flex align-items-center"><div class="profile-avatar"><img src="/avatars/sape.jpg" alt="Sape" class="avatar-image"></div> <div><span>Sape</span>  
        <a href="https://rodolfoberrios.com/" target="_blank" rel="noopener noreferrer" class="external btn btn-sm btn-outline-dark">EL RODO SAPEE!</a></div></div></span><span><div class="d-flex align-items-center"><div class="profile-avatar"><!----></div> <!----></div></span></div></header></div></div> <div class="row justify-content-center text-center mt-4 mb-40"><div class="col-md-9"><img src="/photos/2015-encryption.jpg" class="featured-img"></div></div> <div class="row justify-content-center"><div class="col-md-8"><div itemprop="articleBody" class="content__default"><p>Encryption is the process which encodes or transform data making it useless without the proper decryption mechanism. For example, it allows to transform a file, like a picture, into just useless bytes without the encryption key.</p> <p>For today standards data encryption in a storage service is a must have because it allows a better layer of privacy —a very thin layer anyway— which aims to protect whatever you throw in these services and keep some eyes out of that content. Any storage service made to be used in private or personal environments must have this thing.</p> <h3 id="the-problem-with-encryption"><a href="#the-problem-with-encryption" class="header-anchor">#</a> The problem with encryption</h3> <p>A robust encryption model is quite simple: The user password is the «constant» element to generate encryption keys for each stored file so the encryption and decryption works on-the-fly for each session when someone is logged in. Hopefully all this happens at client side so the decrypted files are never handled by the server.</p> <p>Problem is that this model has several pitfalls when some basic features must be added to the system. For example, if you want to change the password —remember that this is the «constant» key element— you must decrypt and re-encrypt everything. Another example is when someone want to share a file which means that there must be a way to store or include the decryption key somewhere like implicit in the link or in the database. What I’m saying is that this and many other features compromises the strength of the system. There is no way to make the files truly private in any mainstream service with all the fancy features checklist.</p> <h3 id="how-encryption-is-actually-used"><a href="#how-encryption-is-actually-used" class="header-anchor">#</a> How encryption is actually used</h3> <p>Since you can’t fully encrypt the files —without sacrifice several features of the overall system— the deal is just handle a portion of the encryption thing and actually, <strong>the true goal of file encryption in storage services is to blind the storage part</strong>. The files sent to the storage server must be encrypted, which allows to use any third-party service (Amazon S3, Google Cloud, etc.) to store whatever because they won’t be able to index, label or do anything with those encrypted files because they are dealing only with encrypted data which is worthless without the encryption keys.</p> <p><strong>Most storage services store the file encryption keys</strong> which may look bad if you truly care about privacy. The only thing that they do for privacy is that the third-party storage server —and any party with access to the storage server— can’t access to the information directly. This is not that bad if you think about it because by doing this they are abstracting this part of the system.</p> <h3 id="the-mega-client-side-encryption-system"><a href="#the-mega-client-side-encryption-system" class="header-anchor">#</a> The MEGA client-side encryption system</h3> <p>MEGA is not that different from any other storage service and they store the encryption keys like everybody else. They say that the key is behind the user’s password and several other claims that doesn’t seem to be real for what I saw and Arstechnica wrote about MEGA <a href="https://arstechnica.com/business/2013/01/megabad-a-quick-look-at-the-state-of-megas-encryption/" target="_blank" rel="noopener noreferrer">calling it Megabad<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> revealing a lot of issues back in 2013.</p> <p>MEGA is well know because of their privacy —or encryption— concerns. Actually, their motto is «The Privacy Company» so I did some own research to understand how their encryption system works. Honestly, when they launched back in 2013 I didn’t pay to much attention to their encryption mechanism because the things that I code are made to be used in public environments so encryption is not something needed. That has changed a little bit because <strong>I’m planning to add personal modes</strong> to both <a href="https://chevereto.com" target="_blank" rel="noopener noreferrer">Chevereto<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and Quickty and I really like the client-side encryption system used by MEGA which means that the job is done by the web browser, not the remote server.</p> <p>There are several caveats in file encryption and systems designed to deliver this files. <strong>Encrypt and decrypt is something that takes a high load of resources</strong> and on top of that you must deliver this dynamic —or cached— files. If your server will be decrypting files it will eventually get out of resources very quickly and that is why client-side decryption is great because it works directly in the client web browser rather than the remote server. This means <strong>zero server load</strong> for both encryption/decryption and final file delivery processes.</p> <h3 id="missing-things"><a href="#missing-things" class="header-anchor">#</a> Missing things</h3> <p>A client-side decryption model has things that must be worked out. For example, it takes a lot of resources (CPU and RAM) when you download a couple large files at the same time. And <strong>not all the modern web browsers apply the HTML 5 local storage API in the same way</strong>, in most cases the implementation is highly limited. Actually, MEGA works properly only in Chrome and Opera —Opera uses the same Google fork of webkit— so it is still very limited, even in 2015.</p> <p>There are also limitations in mobile devices. In both iOS and Android the browsers has <strong>limitations in the HTML 5 APIs</strong> like local storage or the file API. Even if all the related APIs are fully implemented it won’t be the same thing because of the resources demanded by the processes which have a cap since they are running in a web browser so a custom app is the way to go.</p> <h3 id="conclusions"><a href="#conclusions" class="header-anchor">#</a> Conclusions</h3> <p>A system that works natively only in two major web browsers and that it needs polyfills to make it work is not something good at all. If MEGA started all this thing in 2013 and in two years there are still issues related to cross-browser support means that the future doesn't seem that good for this technique.</p> <p>The only way to guarantee privacy means that several features must be removed and no one does that. File keys are stored to make the whole thing works with all the fancy features that users demands but if the keys are stored somewhere... <strong>What is the point of do any job client-side anyway?</strong>. Maybe it will save server resources but at a ver high cost: Limited support.</p> <p>If the storage service has access to both keys and files —which are in the third-party storage server— there is no additional privacy layer introduced by doing client-side encryption or decryption. Maybe interception if the connection is not secure but if the system connects using a certificate theres no need to do anything else.</p> <p>This client-side encryption system indeed increases user’s privacy but only if the system doesn’t store the keys at all. There are some small services that works like this and those services are really secure but you can do very limited stuff. At the end, <strong>users trend to use the services that will allow them do do more</strong> with their content like sharing or things like that and the privacy is not that bad, at least that is way better than nothing.</p></div></div></div></article> <div class="row justify-content-center"><div class="col-md-9"><!----> <!----></div></div> <div class="row justify-content-center mt-40"><div class="col-md-8"><div class="post-meta"><!----> <!----> <div itemprop="keywords" class="post-meta-tags"><a href="/tag/systems" class="blog-tag" data-v-4217f36d> systems </a></div></div></div></div> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h3 active"><a href="#the-problem-with-encryption" title="The problem with encryption">The problem with encryption</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#how-encryption-is-actually-used" title="How encryption is actually used">How encryption is actually used</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#the-mega-client-side-encryption-system" title="The MEGA client-side encryption system">The MEGA client-side encryption system</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#missing-things" title="Missing things">Missing things</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#conclusions" title="Conclusions">Conclusions</a></div></div></div></div> <footer class="themefooter"><div class="container"><div class="row justify-content-between"><div class="col"><span>Rodolfo blogging since 2012.</span></div> <div class="col text-right"><ul class="list-unstyled"><li class="contact-item"><a href="https://github.com/rodber" target="_blank" rel="noopener noreferrer" class="external"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
              
            </a></li><li class="contact-item"><a href="https://www.linkedin.com/in/rodber/" target="_blank" rel="noopener noreferrer" class="external"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-linkedin"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
              
            </a></li><li class="contact-item"><a href="https://twitter.com/godlike" target="_blank" rel="noopener noreferrer" class="external"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
              
            </a></li><li class="contact-item"><a href="mailto:inbox@rodolfoberrios.com" class="external"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
              
            </a></li><li class="contact-item"><a href="https://rodolfoberrios.com" target="_blank" rel="noopener noreferrer" class="external"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-globe"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>
              
            </a></li></ul> <ul class="list-unstyled"></ul></div></div></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.29ff170a.js" defer></script><script src="/assets/js/6.2d350c7c.js" defer></script><script src="/assets/js/3.042bda6b.js" defer></script><script src="/assets/js/23.64d43cae.js" defer></script>
  </body>
</html>
